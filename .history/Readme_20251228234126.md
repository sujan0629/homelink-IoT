# HomeLink: IoT-Based Smart Home Automation System

## Abstract
HomeLink is an IoT-based smart home automation system that enables remote monitoring and control of household utilities through a mobile application. The system architecture integrates an ESP32 microcontroller running Espruino firmware for hardware interfacing, an Express.js backend server with Socket.IO for real-time bidirectional communication, and a React Native mobile application providing cross-platform user interface. Users can remotely control lighting systems, ceiling fans, water pumps, and electronic door locks while receiving real-time status updates. The ESP32 connects to Wi-Fi and establishes persistent WebSocket connections with the server, processing control commands and broadcasting device states. The Express.js backend manages simultaneous connections from multiple ESP32 devices and mobile clients, ensuring synchronized state propagation across the network. Additional features include real-time door monitoring with position sensors, multi-device support for room-based control, and event logging for activity tracking. All operations utilize Socket.IO's event-driven architecture for low-latency communication. HomeLink demonstrates practical IoT implementation, bridging embedded systems with modern web technologies for accessible home automation.

**Keywords:** IoT, Home automation, ESP32, Real-time communication, Mobile control, Socket.IO.

## Table Of Contents

- [Abstract](#abstract)
- [List of Figures](#list-of-figures)
- [List of Tables](#list-of-tables)
- [List of Abbreviations / Acronyms](#list-of-abbreviations--acronyms)
- [Chapter 1: Introduction](#chapter-1-introduction)
  - [1.1 Background](#11-background)
  - [1.2 Objectives](#12-objectives)
  - [1.3 Motivation and Significance](#13-motivation-and-significance)
  - [1.4 Expected Outcomes](#14-expected-outcomes)
- [Chapter 2: Related Works](#chapter-2-related-works)
  - [2.1 Related Technologies](#21-related-technologies)
  - [2.2 Novel Integration](#22-novel-integration)
- [Chapter 3: Methodology and System Design](#chapter-3-methodology-and-system-design)
  - [3.1 Core Development Phases](#31-core-development-phases)
  - [3.2 System User flow](#32-system-user-flow)
- [Chapter 4: System Requirement Specifications](#chapter-4-system-requirement-specifications)
  - [4.1 Software Specifications](#41-software-specifications)
  - [4.2 Hardware Specifications](#42-hardware-specifications)
- [Chapter 5: Project Planning & Scheduling](#chapter-5-project-planning--scheduling)
- [Appendices](#appendices)
- [References](#references)

## List of Figures
- Figure 1: System Architecture
- Figure 2: Communication Flow & User Interaction

## List of Tables
- Table 1: Hardware Specifications
- Table 2: Project Planning & Scheduling

## List of Abbreviations / Acronyms
- API – Application Programming Interface
- ESP32 – Espressif Systems 32-bit Microcontroller
- GPIO – General Purpose Input/Output
- HTTP – Hypertext Transfer Protocol
- IoT – Internet of Things
- JSON – JavaScript Object Notation
- JWT – JSON Web Token
- LED – Light Emitting Diode
- MongoDB – Document-Oriented NoSQL Database
- REST – Representational State Transfer
- UART – Universal Asynchronous Receiver-Transmitter
- UI – User Interface
- WebSocket – Full-duplex Communication Protocol
- Wi-Fi – Wireless Fidelity
- WSS – WebSocket Secure

## Chapter 1: Introduction

### 1.1 Background
Modern homes increasingly demand intelligent automation systems that provide convenience, energy efficiency, and remote accessibility. Traditional home control systems require manual operation or expensive proprietary solutions with vendor lock-in. HomeLink addresses this gap by creating an open-source, cost-effective IoT solution using widely available components. The system leverages ESP32 microcontrollers for hardware control, Express.js for backend communication, and React Native for cross-platform mobile access. By utilizing WebSocket technology through Socket.IO, the system achieves real-time bidirectional communication essential for responsive home automation. This project demonstrates practical application of full-stack JavaScript development spanning embedded systems, server infrastructure, and mobile applications.

### 1.2 Objectives
- Implement remote control of household utilities (lights, fans, pumps, locks) via mobile application.
- Establish real-time bidirectional communication between hardware and mobile clients using WebSocket protocol.
- Develop ESP32 firmware using Espruino JavaScript runtime for GPIO control and sensor monitoring.
- Create scalable backend architecture supporting multiple devices and concurrent users.
- Design intuitive cross-platform mobile interface with real-time status synchronization.
- Implement door monitoring system with position sensors for security tracking.
- Enable multi-room control with device identification and grouping capabilities.

### 1.3 Motivation and Significance
The increasing adoption of smart home technology highlights the need for accessible, affordable automation solutions that don't require extensive technical expertise. Commercial systems often cost thousands of dollars and lock users into proprietary ecosystems. HomeLink democratizes home automation by using open-source technologies and affordable components (ESP32 modules cost under $5). The project's educational significance lies in demonstrating full-stack IoT development, from low-level hardware interfacing to high-level application design. It showcases how modern JavaScript can span the entire technology stack, making IoT development more accessible to web developers. The system's real-time capabilities ensure immediate feedback and control, crucial for user experience in home automation scenarios.

### 1.4 Expected Outcomes
- Functional prototype controlling 4+ utilities (lights, fans, water pump, door lock).
- Sub-500ms latency for command execution from mobile app to hardware actuation.
- 99%+ uptime with automatic reconnection handling for Wi-Fi and WebSocket disconnections.
- Multi-client support enabling simultaneous control from multiple mobile devices with synchronized state.
- Real-time monitoring of door status (open/closed/locked) with instant mobile notifications.
- Scalable architecture supporting expansion to 10+ rooms and 50+ devices per household.
- Cross-platform mobile app functioning identically on Android and iOS devices.

## Chapter 2: Related Works

### 2.1 Related Technologies
1. **Commercial Smart Home Systems:**
   - Google Home [1] and Amazon Alexa [2] provide voice control but require cloud dependency and subscription services. These systems lack customization options and involve privacy concerns with always-listening devices.

2. **Open-Source IoT Platforms:**
   - Home Assistant [3] offers extensive integration but requires dedicated server hardware and complex configuration. OpenHAB [4] provides device-agnostic control but has steep learning curve for setup.

3. **ESP32-Based Projects:**
   - Blynk [5] offers mobile control for ESP32 but uses proprietary cloud infrastructure with limited free tier. ESPHome [6] focuses on sensor integration rather than comprehensive utility control.

4. **Real-Time Communication:**
   - MQTT protocol [7] is popular for IoT but requires separate broker setup and lacks built-in mobile client libraries. Socket.IO [8] provides easier implementation with automatic fallback mechanisms.

5. **Mobile Frameworks:**
   - Flutter [9] and React Native [10] both enable cross-platform development, with React Native offering better JavaScript ecosystem integration for full-stack projects.

### 2.2 Novel Integration
Existing solutions either require expensive cloud subscriptions (Google Home, Amazon Alexa), complex server setup (Home Assistant, OpenHAB), or use protocols requiring additional infrastructure (MQTT brokers). HomeLink uniquely combines ESP32's affordability and Espruino's JavaScript runtime with Socket.IO's real-time capabilities and React Native's cross-platform reach to create a fully open-source, self-hosted solution requiring only a single-board computer or standard computer as server. The system eliminates cloud dependency while maintaining professional-grade real-time communication, addressing both cost and privacy concerns. This unified JavaScript stack from hardware to mobile application represents a novel approach in the educational IoT domain, making the entire system accessible to developers with web development background rather than requiring embedded systems expertise.

## Chapter 3: Methodology and System Design

### 3.1 Core Development Phases

**Phase 1: Hardware Setup & Firmware Development**
- Configure ESP32 with Espruino firmware and establish Wi-Fi connectivity
- Implement GPIO control logic for relay modules interfacing with home appliances
- Develop sensor reading functionality for door position monitoring
- Create WebSocket client connection logic with automatic reconnection

**Phase 2: Backend Server Development**
- Build Express.js server with Socket.IO integration for WebSocket handling
- Set up MongoDB database with Mongoose schemas for devices, users, and activity logs
- Implement device registration and authentication mechanisms
- Create event routing system for command distribution and status broadcasting
- Develop state management for tracking all connected devices and their current status
- Design database collections for persistent storage of device configurations and command history

**Phase 3: Mobile Application Development**
- Design React Native UI components for device control (switches, sliders, buttons)
- Implement Socket.IO client for real-time communication with server
- Create state management using React hooks for synchronizing UI with device states
- Develop notification system for door status alerts and system events

**Phase 4: Integration & Testing**
- Conduct end-to-end testing of command flow from mobile app to hardware execution
- Perform stress testing with multiple simultaneous client connections
- Test reconnection logic under various network failure scenarios
- Validate real-time synchronization across multiple mobile clients

**Phase 5: Optimization & Documentation**
- Optimize WebSocket message payloads for reduced bandwidth usage
- Implement logging system for debugging and activity monitoring
- Create user documentation and setup guides
- Refine UI/UX based on testing feedback

### 3.2 System User flow
The system operates through a three-tier architecture where the mobile application serves as the presentation layer, the Express.js server as the application layer, and the ESP32 microcontroller as the hardware control layer. When a user interacts with the mobile app (e.g., toggling a light switch), the app emits a Socket.IO event containing the command and target device ID. The Express.js server receives this event, validates the command, and forwards it to the appropriate ESP32 device's WebSocket connection. The ESP32 processes the command, triggers the corresponding GPIO pin to control the relay module, which switches the actual appliance. Simultaneously, the ESP32 reads the new device state and emits a status update event back through the server. The server broadcasts this status to all connected mobile clients, ensuring every user sees the updated state regardless of who initiated the change. This bidirectional flow maintains consistency across the entire system and enables real-time monitoring even when devices are controlled manually through physical switches.

## Chapter 4: System Requirement Specifications

### 4.1 Software Specifications

**Embedded Firmware:**
- Espruino JavaScript firmware for ESP32
- Socket.IO client library for WebSocket communication
- GPIO control libraries for relay module interfacing

**Backend Server:**
- Node.js v18+ runtime environment
- Express.js v4.18+ web framework
- Socket.IO v4.5+ for real-time communication
- MongoDB v6.0+ for event logging, device configuration, and user data persistence
- Mongoose ODM for MongoDB schema management

**Mobile Application:**
- React Native v0.72+ framework
- Socket.IO client library for JavaScript
- React Navigation for app routing
- AsyncStorage for local configuration persistence

**Development Tools:**
- VS Code with ESP32 and React Native extensions
- Git for version control
- Postman for API testing

### 4.2 Hardware Specifications

| Component | Requirements |
|-----------|--------------|
| Microcontroller | ESP32 DevKit (dual-core, Wi-Fi enabled) |
| Relay Modules | 4-channel 5V relay board with optocoupler isolation |
| Power Supply | 5V 2A adapter for ESP32 and relays |
| Sensors | Magnetic door sensor (reed switch) |
| Server Hardware | Raspberry Pi 4 (2GB RAM) or standard PC |
| Network | Wi-Fi router with 2.4GHz support |
| Mobile Device | Android 8.0+ or iOS 12.0+ smartphone |

## Chapter 5: Project Planning & Scheduling

| Week | Phase | Key Deliverables |
|------|-------|------------------|
| 1-2 | Requirements Analysis & Planning | Component procurement, architecture design, development environment setup |
| 3-4 | Hardware Setup & Firmware Development | ESP32 configured with Espruino, GPIO control working, WebSocket client implemented |
| 5-6 | Backend Server Development | Express.js server with Socket.IO, device registration system, event routing logic |
| 7-8 | Mobile App Development | React Native UI completed, Socket.IO integration, control functionality working |
| 9 | Integration & Testing | End-to-end testing, multi-client testing, reconnection scenarios validated |
| 10 | Optimization & Documentation | Performance tuning, user guide creation, final presentation preparation |

## Appendices
### (Technical Implementation Details)

**A1. ESP32 GPIO Pin Configuration**
- GPIO 2, 4, 5, 18: Connected to relay module inputs (IN1-IN4) for controlling lights, fan, pump, and lock
- GPIO 21: Connected to door sensor (reed switch) with internal pull-up resistor
- GPIO 1 (TX), GPIO 3 (RX): UART pins reserved for debugging output

**A2. WebSocket Event Schema**
- Client → Server: `{ event: "control-device", deviceId: "esp32-001", utility: "light", state: true }`
- Server → ESP32: `{ event: "execute-command", utility: "light", state: true }`
- ESP32 → Server: `{ event: "status-update", deviceId: "esp32-001", utility: "light", state: true }`
- Server → Clients: `{ event: "device-state-changed", deviceId: "esp32-001", utility: "light", state: true }`

**A3. Relay Control Logic**
- Active-Low Configuration: Relay modules activate when GPIO pin is LOW (0V)
- Safety Implementation: Initialize all pins to HIGH on startup to prevent accidental device activation
- Debouncing: 50ms delay after relay switching to prevent contact bounce

**A4. Reconnection Strategy**
- ESP32: Exponential backoff (2s, 4s, 8s, max 30s) for Wi-Fi and WebSocket reconnection attempts
- Mobile App: Automatic reconnection on app resume with visual connection status indicator
- Server: Cleanup disconnected client sockets after 60-second timeout

**A6. MongoDB Database Schema**
- Devices Collection: `{ deviceId, name, type, room, status, lastSeen, registeredAt }`
- Users Collection: `{ userId, username, email, hashedPassword, devices[], createdAt }`
- ActivityLogs Collection: `{ timestamp, deviceId, action, user, previousState, newState }`
- Rooms Collection: `{ roomId, name, devices[], createdAt }`

## References

1. Google LLC, "Google Home Developer Documentation," 2024. [Online]. Available: https://developers.google.com/assistant/smarthome/overview.
2. Amazon.com, Inc., "Alexa Smart Home Skill API," 2024. [Online]. Available: https://developer.amazon.com/docs/smarthome/understand-the-smart-home-skill-api.html.
3. Home Assistant, "Home Assistant Documentation," 2024. [Online]. Available: https://www.home-assistant.io/docs/.
4. openHAB Foundation, "openHAB Documentation," 2024. [Online]. Available: https://www.openhab.org/docs/.
5. Blynk Inc., "Blynk IoT Platform Documentation," 2024. [Online]. Available: https://docs.blynk.io/.
6. ESPHome, "ESPHome Documentation," 2024. [Online]. Available: https://esphome.io/.
7. OASIS, "MQTT Version 5.0," OASIS Standard, 2019.
8. Socket.IO, "Socket.IO Documentation," 2024. [Online]. Available: https://socket.io/docs/v4/.
9. Google, "Flutter Documentation," 2024. [Online]. Available: https://docs.flutter.dev/.
10. Meta Platforms, Inc., "React Native Documentation," 2024. [Online]. Available: https://reactnative.dev/docs/getting-started.
11. Espruino, "Espruino on ESP32 Documentation," 2024. [Online]. Available: https://www.espruino.com/ESP32.
12. N. Kolban, "Kolban's Book on ESP32," 2018. [Online]. Available: https://leanpub.com/kolban-ESP32.
13. MongoDB, Inc., "MongoDB Documentation," 2024. [Online]. Available: https://docs.mongodb.com/.
14. Automattic, "Mongoose ODM Documentation," 2024. [Online]. Available: https://mongoosejs.com/docs/.
